(self.webpackChunkbuildmarket_angular=self.webpackChunkbuildmarket_angular||[]).push([[324],{5324:(t,e,o)=>{"use strict";o.r(e),o.d(e,{OrderPageModule:()=>vt});var i=o(1116),r=o(1334),n=o(4689),c=o(1462),a=o(2935),s=o(5366),p=o(5031),d=o(8207),u=o(6455),l=o(994),g=o(3782),m=o(374),_=o(7672),h=o(8293);const f=["checkbox"];function x(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"span",10),s.TgZ(1,"a",11),s.NdJ("click",function(e){const o=s.CHM(t).$implicit;return s.oxw(4).typeClick(e,o.id||"")}),s._uU(2),s.qZA(),s.qZA()}if(2&t){const t=e.$implicit;s.xp6(2),s.Oqu(t.title)}}function b(t,e){if(1&t&&(s.ynx(0),s.TgZ(1,"div",8),s.YNc(2,x,3,1,"span",9),s.qZA(),s.BQk()),2&t){const t=s.oxw(3);s.xp6(2),s.Q6J("ngForOf",t.types)}}function Z(t,e){if(1&t&&(s.TgZ(0,"div"),s.TgZ(1,"div",7),s._uU(2,"\u041a\u0430\u0442\u0430\u043b\u043e\u0433 \u0442\u043e\u0432\u0430\u0440\u0456\u0432"),s.qZA(),s.YNc(3,b,3,1,"ng-container",6),s.qZA()),2&t){const t=s.oxw(2);s.xp6(3),s.Q6J("ngIf",t.types)}}function v(t,e){if(1&t&&(s.TgZ(0,"span"),s._uU(1),s.qZA()),2&t){const t=s.oxw(3).$implicit;s.xp6(1),s.hij(" ",t.unit,"")}}function w(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"div"),s.TgZ(1,"mat-checkbox",23,24),s.NdJ("change",function(){return s.CHM(t),s.oxw(7).checkboxChange()}),s.TgZ(3,"span"),s._uU(4),s.qZA(),s.YNc(5,v,2,1,"span",6),s.qZA(),s.qZA()}if(2&t){const t=e.$implicit,o=s.oxw(2).$implicit;s.xp6(1),s.hYB("name","",o.title,"::",t,""),s.xp6(3),s.Oqu(t),s.xp6(1),s.Q6J("ngIf",!!o.unit)}}function y(t,e){if(1&t&&(s.ynx(0),s.TgZ(1,"h2",21),s._uU(2),s.qZA(),s.TgZ(3,"div",22),s.YNc(4,w,6,4,"div",20),s.qZA(),s.BQk()),2&t){const t=s.oxw().$implicit,e=s.oxw(5);s.xp6(2),s.Oqu(t.title),s.xp6(2),s.Q6J("ngForOf",e.parametersObject[t.title])}}function A(t,e){if(1&t&&(s.ynx(0),s.YNc(1,y,5,2,"ng-container",6),s.BQk()),2&t){const t=e.$implicit,o=s.oxw(5);s.xp6(1),s.Q6J("ngIf",o.parametersObject[t.title].length>0)}}function T(t,e){if(1&t&&(s.ynx(0),s.YNc(1,A,2,1,"ng-container",20),s.BQk()),2&t){const t=s.oxw(4);s.xp6(1),s.Q6J("ngForOf",t.type.parameters)}}function q(t,e){if(1&t&&(s.TgZ(0,"div",19),s.YNc(1,T,2,1,"ng-container",6),s.qZA()),2&t){const t=s.oxw(3);s.xp6(1),s.Q6J("ngIf",t.type.parameters&&t.type.parameters.length>0)}}function C(t,e){1&t&&(s.TgZ(0,"div",25),s._uU(1,"\u041d\u0430 \u0436\u0430\u043b\u044c, \u0442\u043e\u0432\u0430\u0440\u0438 \u0432\u0456\u0434\u0441\u0443\u0442\u043d\u0456"),s.qZA())}function P(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"div",26),s.NdJ("getProductID",function(e){return s.CHM(t),s.oxw(3).getProductID(e)})("addProductToOrder",function(e){return s.CHM(t),s.oxw(3).addProductToOrder(e)}),s.qZA()}if(2&t){const t=e.$implicit;s.Q6J("isPopupAddProduct",!0)("product",t)}}function k(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"div"),s.TgZ(1,"button",12),s.NdJ("click",function(){return s.CHM(t),s.oxw(2).backToStep1()}),s._UZ(2,"span"),s.qZA(),s.TgZ(3,"div",7),s._uU(4),s.qZA(),s.TgZ(5,"div",13),s.YNc(6,q,2,1,"div",14),s.TgZ(7,"div",15),s.TgZ(8,"div",16),s.YNc(9,C,2,0,"div",17),s.YNc(10,P,1,2,"div",18),s.ALo(11,"filterProducts"),s.qZA(),s.qZA(),s.qZA(),s.qZA()}if(2&t){const t=s.oxw(2);s.xp6(4),s.Oqu(t.type.title),s.xp6(2),s.Q6J("ngIf",t.type),s.xp6(3),s.Q6J("ngIf",0===t.products.length),s.xp6(1),s.Q6J("ngForOf",s.xi3(11,4,t.products,t.filterData))}}const O=function(t,e){return{typeID:t,productID:e}};function I(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"div"),s.TgZ(1,"button",12),s.NdJ("click",function(){return s.CHM(t),s.oxw(2).backToStep2()}),s._UZ(2,"span"),s.qZA(),s.TgZ(3,"app-product-page",27),s.NdJ("addProductToOrder",function(e){return s.CHM(t),s.oxw(2).addProductToOrder(e)}),s.qZA(),s.qZA()}if(2&t){const t=s.oxw(2);s.xp6(3),s.Q6J("popupConfig",s.WLB(2,O,t.typeID,t.productID))("isPopupAddProduct",!0)}}function M(t,e){if(1&t&&(s.ynx(0),s.TgZ(1,"div",3),s._uU(2," \u041d\u043e\u0432\u0438\u0439 \u0442\u043e\u0432\u0430\u0440 "),s.TgZ(3,"button",4),s._UZ(4,"span"),s.qZA(),s.qZA(),s.TgZ(5,"div",5),s.YNc(6,Z,4,1,"div",6),s.YNc(7,k,12,7,"div",6),s.YNc(8,I,4,5,"div",6),s.qZA(),s.BQk()),2&t){const t=s.oxw();s.xp6(3),s.Q6J("mat-dialog-close",!1),s.xp6(3),s.Q6J("ngIf",t.step1),s.xp6(1),s.Q6J("ngIf",t.step2),s.xp6(1),s.Q6J("ngIf",t.step3)}}function J(t,e){1&t&&s._UZ(0,"mat-spinner",28)}let N=(()=>{class t{constructor(t,e,o,i,r){this.data=t,this._dialogRef=e,this._productService=o,this._productTypeService=i,this._storeService=r,this.filterData={},this.showPreloader=!0,this.parametersObject={},this.productID="",this.products=[],this.step1=!0,this.step2=!1,this.step3=!1,this.typeID=""}addProductToOrder(t){this._dialogRef.close(t)}backToStep1(){this.typeID="",this.filterData={},this.step2=!1,this.step1=!0}backToStep2(){this.filterData={},this.step3=!1,this.step2=!0}checkboxChange(){this.filterData={},this.checkboxes.forEach(t=>{var e;if(t.checked){const o=null===(e=t.name)||void 0===e?void 0:e.split("::");if(!o)return;this.filterData[o[0]]=this.filterData[o[0]]?[...this.filterData[o[0]].concat(),o[1]]:[o[1]]}})}getProductID(t){this.productID=t,this.showStep3()}getProductsByTypeID(){if(!this.type.id)return this.products=[],void(this.showPreloader=!1);this._productService.getProductsByType(this.type.id).subscribe(t=>{this.products=t,this.parametersObjectFilling(),this.showPreloader=!1})}getType(t){this._productTypeService.getType(t).subscribe(t=>{this.type=t,this.type?(this.type.parameters&&this.type.parameters.forEach(t=>{this.parametersObject[t.title]=[]}),this.getProductsByTypeID()):this.showPreloader=!1})}getTypesList(){const t=this._productTypeService.getTypes().subscribe(e=>{this.types=e,this.types.sort((t,e)=>t.title<e.title?-1:t.title>e.title?1:0),this.showPreloader=!1,t.unsubscribe()})}ngOnInit(){this.getTypesList()}parametersObjectFilling(){this.products.forEach(t=>{t.parameters&&t.parameters.forEach(t=>{this.parametersObject[t.title].includes(t.value)||this.parametersObject[t.title].push(t.value);const e=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});this.parametersObject[t.title].sort(e.compare)})})}showStep2(t){this.step1=!1,this.step2=!0,this.getType(t)}showStep3(){this.step2=!1,this.step3=!0}typeClick(t,e){t.stopPropagation(),t.preventDefault(),""!==e?(this.typeID=e,this.showPreloader=!0,this.showStep2(e)):console.error("typeID is empty")}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(a.WI),s.Y36(a.so),s.Y36(p.M),s.Y36(d.c),s.Y36(u.d))},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-popup-add-product"]],viewQuery:function(t,e){if(1&t&&s.Gf(f,5),2&t){let t;s.iGM(t=s.CRH())&&(e.checkboxes=t)}},decls:4,vars:2,consts:[[1,"catalog-popup"],[4,"ngIf","ngIfElse"],["loading",""],[1,"catalog-popup__head"],["type","button",1,"catalog-popup__close",3,"mat-dialog-close"],[1,"catalog-popup__wrap"],[4,"ngIf"],[1,"catalog-popup__title"],[1,"catalog-popup__categories","catalog-popup__categories"],["class","catalog-popup__categories-item",4,"ngFor","ngForOf"],[1,"catalog-popup__categories-item"],["href","#",1,"catalog-popup__categories-link",3,"click"],["title","\u041f\u043e\u043f\u0435\u0440\u0435\u0434\u043d\u0456\u0439 \u043a\u0440\u043e\u043a",1,"catalog-popup__back",3,"click"],[1,"catalog-popup__type"],["class","catalog-popup__type-menu sticky-column",4,"ngIf"],[1,"catalog-popup__type-wrap","sticky-column"],[1,"catalog-popup__type-cards"],["class","catalog-popup__empty-cards",4,"ngIf"],["app-card","","class","card",3,"isPopupAddProduct","product","getProductID","addProductToOrder",4,"ngFor","ngForOf"],[1,"catalog-popup__type-menu","sticky-column"],[4,"ngFor","ngForOf"],[1,"catalog-popup__type-title"],[1,"catalog-popup__type-section"],[3,"name","change"],["checkbox",""],[1,"catalog-popup__empty-cards"],["app-card","",1,"card",3,"isPopupAddProduct","product","getProductID","addProductToOrder"],[3,"popupConfig","isPopupAddProduct","addProductToOrder"],[1,"loading-type-1"]],template:function(t,e){if(1&t&&(s.TgZ(0,"div",0),s.YNc(1,M,9,4,"ng-container",1),s.YNc(2,J,1,0,"ng-template",null,2,s.W1O),s.qZA()),2&t){const t=s.MAs(3);s.xp6(1),s.Q6J("ngIf",!e.showPreloader)("ngIfElse",t)}},directives:[i.O5,a.ZT,i.sg,l.oG,g.A,m.p,_.$g],pipes:[h.s],styles:['.catalog-popup[_ngcontent-%COMP%]{margin:0 -24px;font-family:Inter,sans-serif}.catalog-popup__head[_ngcontent-%COMP%]{position:relative;font-size:20px;padding:0 55px 24px 24px;margin-bottom:24px;font-weight:500;line-height:1.3;border-bottom:1px solid var(--border-color)}.catalog-popup__close[_ngcontent-%COMP%]{position:absolute;top:4px;right:10px;border:none;background:none;padding:0}.catalog-popup__close[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;position:relative;width:20px;height:20px}.catalog-popup__close[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:after, .catalog-popup__close[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:before{content:"";position:absolute;top:10px;left:0;width:20px;height:1px;background:var(--remove-color-1);transform:rotate(45deg)}.catalog-popup__close[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:after{transform:rotate(-45deg)}.catalog-popup__wrap[_ngcontent-%COMP%]{padding:0 24px}.catalog-popup__title[_ngcontent-%COMP%]{font-size:18px;margin-bottom:15px;font-weight:500;line-height:1.3}.catalog-popup__categories-item[_ngcontent-%COMP%]{display:block}.catalog-popup__categories-link[_ngcontent-%COMP%]{display:inline-block;color:var(--font-color-3);font-size:16px;line-height:1.2;padding:4px 0}.catalog-popup__type-menu[_ngcontent-%COMP%]{margin-bottom:30px}.catalog-popup__type-title[_ngcontent-%COMP%]{margin-bottom:10px;font-family:Inter,sans-serif;font-size:16px;line-height:1.3;font-weight:400}.catalog-popup__type-section[_ngcontent-%COMP%]{margin-bottom:15px}.catalog-popup__type-cards[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:stretch;margin:0 -15px}.catalog-popup__empty-cards[_ngcontent-%COMP%]{font-size:16px;font-weight:700;font-family:Inter,sans-serif;padding:0 15px;margin-bottom:30px}.catalog-popup__back[_ngcontent-%COMP%]{margin-bottom:24px;border:none;background:none;padding:0}.catalog-popup__back[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;width:48px;height:30px;background:url(/assets/img/arrow-left.svg) no-repeat 50%;background-size:cover}@media screen and (min-width:768px){.catalog-popup__type[_ngcontent-%COMP%]{display:flex;align-items:flex-start}.catalog-popup__type-menu[_ngcontent-%COMP%]{width:300px;padding-right:15px;border:none}.catalog-popup__type-wrap[_ngcontent-%COMP%]{padding-left:15px;width:calc(100% - 300px)}.catalog-popup__empty-cards[_ngcontent-%COMP%]{font-size:20px}.sticky-column[_ngcontent-%COMP%]{position:sticky;top:0}}@media screen and (min-width:1024px){.catalog-popup__empty-cards[_ngcontent-%COMP%]{font-size:24px}}']}),t})();var Q=o(7777),D=o(1179);let S=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-characteristic"]],inputs:{item:["characteristic","item"]},decls:5,vars:2,consts:[[1,"characteristic"],[1,"characteristic__title"],[1,"characteristic__title-wrap",3,"innerHTML"],[1,"characteristic__inner"],[1,"characteristic__inner-wrap",3,"innerHTML"]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"div",1),s._UZ(2,"div",2),s.qZA(),s.TgZ(3,"div",3),s._UZ(4,"div",4),s.qZA(),s.qZA()),2&t&&(s.xp6(2),s.Q6J("innerHTML",e.item.title,s.oJD),s.xp6(2),s.Q6J("innerHTML",e.item.characteristic,s.oJD))},styles:['.characteristic[_ngcontent-%COMP%]{margin-bottom:15px}.characteristic__title[_ngcontent-%COMP%]{line-height:1.3;font-weight:500}.characteristic__title-wrap[_ngcontent-%COMP%]{margin-bottom:3px}.characteristic__inner[_ngcontent-%COMP%]{line-height:1.3;font-weight:300}@media screen and (min-width:768px){.characteristic[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:space-between;position:relative}.characteristic[_ngcontent-%COMP%]:before{content:"";position:absolute;left:0;bottom:4px;width:100%;border-bottom:1px dotted var(--border-color)}.characteristic__title[_ngcontent-%COMP%]{position:relative;align-self:flex-start;width:40%}.characteristic__title-wrap[_ngcontent-%COMP%]{position:relative;display:inline-block;padding-right:15px;background:#fff;margin-bottom:0}.characteristic__inner[_ngcontent-%COMP%]{width:60%;text-align:right}.characteristic__inner-wrap[_ngcontent-%COMP%]{position:relative;display:inline-block;padding-left:15px;background:#fff}}']}),t})();var U=o(3070),Y=o(3841),F=o(7064),z=o(9550),B=o(1663);const H=["amountInput"];function L(t,e){if(1&t&&s._UZ(0,"img",20),2&t){const t=s.oxw();s.s9C("src",t.product.images[0].original,s.LSH),s.s9C("alt",t.product.title)}}const j=function(t,e){return["/catalog",t,e]};let E=(()=>{class t{constructor(t){this._productService=t,this.removeProduct=new s.vpe,this.changeProductAmount=new s.vpe}changeAmount(t){if(this.product.amount<2&&t<0)return!1;this.product.amount+=t,this.updateOrderItemTotalPrice(),this.changeProductAmount.emit()}inputChange(t){let e=t.target.value;(isNaN(e)||e<1||""===e)&&(e=1,this.product.amount=e,this.amountInput.nativeElement.value=e),this.updateOrderItemTotalPrice(),this.changeProductAmount.emit()}inputJustNumbers(t){t.keyCode>47&&t.keyCode<58||8===t.keyCode||46===t.keyCode||9===t.keyCode||27===t.keyCode||37===t.keyCode||39===t.keyCode||t.preventDefault()}ngOnInit(){this.updateOrderPrice(),this.updateOrderItemTotalPrice()}removeItem(){this.removeProduct.emit({typeID:this.product.type,productID:this.product.id})}updateOrderItemTotalPrice(){this.product.totalPrice=+this.product.price*this.product.amount}updateOrderPrice(){const t=this._productService.getByTypeAndID(this.product.type,this.product.id).subscribe(e=>{this.product.price=e.price,t.unsubscribe()})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(p.M))},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-order-item"]],viewQuery:function(t,e){if(1&t&&s.Gf(H,5),2&t){let t;s.iGM(t=s.CRH())&&(e.amountInput=t.first)}},inputs:{product:"product"},outputs:{removeProduct:"removeProduct",changeProductAmount:"changeProductAmount"},decls:32,vars:24,consts:[[1,"order-item"],["target","_blank",1,"order-item__pic",3,"routerLink"],["class","order-item__pic-inner",3,"src","alt",4,"ngIf"],[1,"order-item__wrap"],[1,"order-item__title"],["target","_blank",1,"order-item__title-link",3,"routerLink"],[1,"order-item__cost"],[1,"order-item__cost-value"],[1,"order-item__cost-currency"],[1,"order-item__cover"],[1,"order-item__controls"],["type","button",1,"order-item__minus",3,"disabled","click"],["appearance","outline"],["type","text","matInput","",3,"ngModel","keydown","input","ngModelChange"],["amountInput",""],["type","button",1,"order-item__plus",3,"click"],[1,"order-item__price"],[1,"order-item__price-value"],[1,"order-item__price-currency"],["type","button",1,"order-item__remove",3,"click"],[1,"order-item__pic-inner",3,"src","alt"]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"a",1),s.YNc(2,L,1,2,"img",2),s.qZA(),s.TgZ(3,"div",3),s.TgZ(4,"div",4),s.TgZ(5,"a",5),s._uU(6),s.qZA(),s.qZA(),s.TgZ(7,"div",6),s.TgZ(8,"span",7),s._uU(9),s.ALo(10,"removeComma"),s.ALo(11,"number"),s.qZA(),s.TgZ(12,"span",8),s._uU(13,"\u0433\u0440\u043d"),s.qZA(),s.qZA(),s.TgZ(14,"div",9),s.TgZ(15,"div",10),s.TgZ(16,"button",11),s.NdJ("click",function(){return e.changeAmount(-1)}),s._UZ(17,"span"),s.qZA(),s.TgZ(18,"mat-form-field",12),s.TgZ(19,"input",13,14),s.NdJ("keydown",function(t){return e.inputJustNumbers(t)})("input",function(t){return e.inputChange(t)})("ngModelChange",function(t){return e.product.amount=t}),s.qZA(),s.qZA(),s.TgZ(21,"button",15),s.NdJ("click",function(){return e.changeAmount(1)}),s._UZ(22,"span"),s.qZA(),s.qZA(),s.TgZ(23,"div",16),s.TgZ(24,"span",17),s._uU(25),s.ALo(26,"removeComma"),s.ALo(27,"number"),s.qZA(),s.TgZ(28,"span",18),s._uU(29,"\u0433\u0440\u043d"),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.TgZ(30,"button",19),s.NdJ("click",function(){return e.removeItem()}),s._UZ(31,"span"),s.qZA(),s.qZA()),2&t&&(s.xp6(1),s.Q6J("routerLink",s.WLB(18,j,e.product.type,e.product.id)),s.xp6(1),s.Q6J("ngIf",e.product.images),s.xp6(3),s.Q6J("routerLink",s.WLB(21,j,e.product.type,e.product.id)),s.xp6(1),s.Oqu(e.product.title),s.xp6(3),s.Oqu(s.lcZ(10,8,s.xi3(11,10,e.product.price,"1.2-2"))),s.xp6(7),s.Q6J("disabled",e.product.amount<2),s.xp6(3),s.Q6J("ngModel",e.product.amount),s.xp6(6),s.Oqu(s.lcZ(26,13,s.xi3(27,15,e.product.totalPrice,"1.2-2"))))},directives:[r.yS,i.O5,U.KE,z.Nt,c.Fj,c.JJ,c.On],pipes:[B.f,i.JJ],styles:['.order-item{display:flex;align-items:flex-start;position:relative;border:1px solid var(--block-bg-2);padding:10px;margin-bottom:15px}.order-item__pic{display:block}.order-item__pic-inner{display:block;width:72px;height:72px;object-fit:contain;object-position:center}.order-item__wrap{padding-left:10px;width:calc(100% - 72px)}.order-item__title{padding-right:30px;margin-bottom:5px}.order-item__title-link{color:var(--font-color-1);border-bottom:1px solid #0000;transition:border-bottom .3s ease;line-height:1.3;font-size:15px;font-weight:500}.order-item__controls{display:flex;align-items:center;margin:0 5px 7px 0}.order-item__controls .mat-form-field-infix{border-top:none;padding:0;width:100%}.order-item__controls .mat-form-field{width:40px;margin:0 5px}.order-item__controls .mat-input-element{text-align:center;font-size:14px;height:30px;margin:0;padding:0 5px;box-sizing:border-box}.order-item__controls .mat-form-field-wrapper{margin:0;padding:0}.order-item__controls .mat-form-field-appearance-outline .mat-form-field-outline{top:0}.order-item__controls .mat-form-field-appearance-outline .mat-form-field-wrapper{margin:0}.order-item__controls .mat-form-field-appearance-outline .mat-form-field-flex{margin:0;padding:0}.order-item__minus,.order-item__plus{border:none;background:none;padding:0}.order-item__minus[disabled],.order-item__plus[disabled]{opacity:.3}.order-item__minus span,.order-item__plus span{display:block;position:relative;width:24px;height:24px}.order-item__minus span:before,.order-item__plus span:after,.order-item__plus span:before{content:"";position:absolute;top:12px;left:2px;width:20px;height:2px;background:var(--brand-color-2);transition:background .3s ease}.order-item__plus span:after{transform:rotate(90deg)}.order-item__price{line-height:1;color:var(--font-color-1);font-weight:700;-webkit-user-select:none;user-select:none;white-space:nowrap}.order-item__price-value{font-size:18px}.order-item__price-currency{font-size:15px;margin-left:4px}.order-item__remove{position:absolute;top:10px;right:10px;border:none;background:none;padding:0}.order-item__remove span{display:block;position:relative;width:20px;height:20px}.order-item__remove span:after,.order-item__remove span:before{content:"";position:absolute;top:10px;left:0;width:20px;height:1px;background:var(--remove-color-1);transform:rotate(45deg)}.order-item__remove span:after{transform:rotate(-45deg)}.order-item__cost{margin-bottom:5px}.order-item__cost-value{font-size:15px}.order-item__cost-currency{font-size:12px;margin-left:3px}@media screen and (min-width:540px){.order-item__cover{display:flex;justify-content:space-between;align-items:center}.order-item__controls{margin-bottom:0}}@media screen and (min-width:1024px){.order-item__title-link{font-size:17px}.order-item__title:hover .order-item__title-link{border-bottom-color:initial}.order-item__minus:not([disabled]):hover span:before,.order-item__plus:not([disabled]):hover span:after,.order-item__plus:not([disabled]):hover span:before{background:#000}}'],encapsulation:2}),t})();const $=function(t){return{characteristic:t,title:"\u0414\u0430\u0442\u0430 \u043e\u0441\u0442\u0430\u043d\u043d\u044c\u043e\u0433\u043e \u0440\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u043d\u043d\u044f"}};function K(t,e){if(1&t&&(s._UZ(0,"app-characteristic",8),s.ALo(1,"date")),2&t){const t=s.oxw(2);let e;s.Q6J("characteristic",s.VKq(4,$,(null==(e=s.xi3(1,1,t.order.dateOfChange,"dd.MM.yyyy, HH:mm:ss"))?null:e.toString())||""))}}const V=function(t){return{characteristic:t,title:"\u041a\u0456\u043b\u044c\u043a\u0456\u0441\u0442\u044c \u043f\u043e\u0437\u0438\u0446\u0456\u0439"}};function G(t,e){if(1&t&&s._UZ(0,"app-characteristic",8),2&t){const t=s.oxw(2);s.Q6J("characteristic",s.VKq(1,V,t.order.goods.length.toString()))}}function W(t,e){if(1&t&&(s.TgZ(0,"mat-option",30),s._uU(1),s.qZA()),2&t){const t=e.$implicit,o=e.index,i=s.oxw(2);s.s9C("value",t),s.xp6(1),s.Oqu(i.statusesValues[o])}}function R(t,e){if(1&t){const t=s.EpF();s.ynx(0),s.TgZ(1,"app-order-item",32),s.NdJ("removeProduct",function(e){return s.CHM(t),s.oxw(3).removeProduct(e)})("changeProductAmount",function(){return s.CHM(t),s.oxw(3).updateProduct()}),s.qZA(),s.BQk()}if(2&t){const t=e.$implicit;s.xp6(1),s.Q6J("product",t)}}function X(t,e){if(1&t&&(s.ynx(0),s.TgZ(1,"div",20),s.YNc(2,R,2,1,"ng-container",31),s.qZA(),s.BQk()),2&t){const t=s.oxw(2);s.xp6(2),s.Q6J("ngForOf",t.order.goods)}}function tt(t,e){if(1&t&&(s.TgZ(0,"div",24),s.TgZ(1,"div",25),s._uU(2,"\u041a\u043e\u043c\u0435\u043d\u0442\u0430\u0440 \u0437\u0430\u043c\u043e\u0432\u043d\u0438\u043a\u0430"),s.qZA(),s.TgZ(3,"div",21),s.TgZ(4,"div",33),s._uU(5),s.qZA(),s.qZA(),s.qZA()),2&t){const t=s.oxw(2);s.xp6(5),s.Oqu(t.order.commentCustomer)}}function et(t,e){if(1&t&&(s.TgZ(0,"div",21),s.TgZ(1,"div",33),s._uU(2),s.qZA(),s.TgZ(3,"div",34),s._uU(4),s.ALo(5,"date"),s.qZA(),s.qZA()),2&t){const t=e.$implicit;s.xp6(2),s.Oqu(t.text),s.xp6(2),s.AsE(" ",s.xi3(5,3,t.date,"dd.MM.yyyy, HH:mm:ss")," (",t.user,") ")}}function ot(t,e){1&t&&(s.TgZ(0,"div",20),s.TgZ(1,"div",21),s.TgZ(2,"mat-form-field",35),s.TgZ(3,"mat-label"),s._uU(4,"\u041a\u043e\u043c\u0435\u043d\u0442\u0430\u0440 (\u043d\u0435\u043e\u0431\u043e\u0432\u02bc\u044f\u0437\u043a\u043e\u0432\u043e)"),s.qZA(),s._UZ(5,"textarea",36),s.qZA(),s.qZA(),s.qZA())}function it(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"div",20),s.TgZ(1,"div",21),s.TgZ(2,"button",22),s.NdJ("click",function(){return s.CHM(t),s.oxw(2).showCommentField()}),s.TgZ(3,"span"),s._uU(4,"\u041d\u043e\u0432\u0438\u0439 \u043a\u043e\u043c\u0435\u043d\u0442\u0430\u0440"),s.qZA(),s.qZA(),s.qZA(),s.qZA()}}const rt=function(t){return{characteristic:t,title:"ID \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f"}},nt=function(t){return{characteristic:t,title:"\u0406\u043c\u02bc\u044f"}},ct=function(t){return{characteristic:t,title:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d"}},at=function(t){return{characteristic:t,title:"\u0421\u0443\u043c\u0430"}},st=function(t){return{characteristic:t,title:"\u0414\u0430\u0442\u0430 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f"}};function pt(t,e){if(1&t){const t=s.EpF();s.ynx(0),s.TgZ(1,"form",4),s.NdJ("ngSubmit",function(){return s.CHM(t),s.oxw().submit()}),s.TgZ(2,"div",5),s.TgZ(3,"div",6),s.TgZ(4,"div",7),s._UZ(5,"app-characteristic",8),s._UZ(6,"app-characteristic",8),s._UZ(7,"app-characteristic",8),s._UZ(8,"app-characteristic",8),s.ALo(9,"removeComma"),s.ALo(10,"number"),s._UZ(11,"app-characteristic",8),s.ALo(12,"date"),s.YNc(13,K,2,6,"app-characteristic",9),s.YNc(14,G,1,3,"app-characteristic",9),s.TgZ(15,"div",10),s.TgZ(16,"div",11),s.TgZ(17,"div",12),s._uU(18,"\u0421\u0442\u0430\u0442\u0443\u0441"),s.qZA(),s.qZA(),s.TgZ(19,"div",13),s.TgZ(20,"div",14),s.TgZ(21,"mat-form-field",15),s.TgZ(22,"mat-select",16),s.NdJ("selectionChange",function(e){return s.CHM(t),s.oxw().statusChange(e)}),s.YNc(23,W,2,2,"mat-option",17),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.TgZ(24,"div",5),s.TgZ(25,"div",18),s.YNc(26,X,3,1,"ng-container",19),s.TgZ(27,"div",20),s.TgZ(28,"div",21),s.TgZ(29,"button",22),s.NdJ("click",function(){return s.CHM(t),s.oxw().newProductPopup()}),s.TgZ(30,"span"),s._uU(31,"\u041d\u043e\u0432\u0438\u0439 \u0442\u043e\u0432\u0430\u0440"),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.TgZ(32,"div",18),s.YNc(33,tt,6,1,"div",23),s.TgZ(34,"div",24),s.TgZ(35,"div",25),s._uU(36,"\u041a\u043e\u043c\u0435\u043d\u0442\u0430\u0440\u0456 \u043c\u0435\u043d\u0435\u0434\u0436\u0435\u0440\u0456\u0432"),s.qZA(),s.YNc(37,et,6,6,"div",26),s.YNc(38,ot,6,0,"div",27),s.YNc(39,it,5,0,"div",27),s.qZA(),s.qZA(),s.qZA(),s.TgZ(40,"div",28),s.TgZ(41,"button",29),s._uU(42,"\u041e\u043d\u043e\u0432\u0438\u0442\u0438 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f"),s.qZA(),s.qZA(),s.qZA(),s.BQk()}if(2&t){const t=s.oxw();let e;s.xp6(1),s.Q6J("formGroup",t.form),s.xp6(4),s.Q6J("characteristic",s.VKq(23,rt,t.order.id)),s.xp6(1),s.Q6J("characteristic",s.VKq(25,nt,t.order.customerName)),s.xp6(1),s.Q6J("characteristic",s.VKq(27,ct,t.order.phone)),s.xp6(1),s.Q6J("characteristic",s.VKq(29,at,"<b>"+s.lcZ(9,15,s.xi3(10,17,t.order.totalAmount,"1.2-2")).toString()+" \u0433\u0440\u043d.</b>")),s.xp6(3),s.Q6J("characteristic",s.VKq(31,st,(null==(e=s.xi3(12,20,t.order.date,"dd.MM.yyyy, HH:mm:ss"))?null:e.toString())||"")),s.xp6(2),s.Q6J("ngIf",t.order.dateOfChange),s.xp6(1),s.Q6J("ngIf",t.order.goods),s.xp6(9),s.Q6J("ngForOf",t.statusesKeys),s.xp6(3),s.Q6J("ngIf",!!t.order.goods&&t.order.goods.length>0),s.xp6(7),s.Q6J("ngIf",!!t.order.commentCustomer),s.xp6(4),s.Q6J("ngForOf",t.order.commentManager),s.xp6(1),s.Q6J("ngIf",t.isNewComment),s.xp6(1),s.Q6J("ngIf",!t.isNewComment),s.xp6(2),s.Q6J("disabled",t.form.invalid||!t.isChange||t.submitted)}}function dt(t,e){1&t&&s._UZ(0,"mat-spinner",37)}const ut=[{path:"",component:(()=>{class t{constructor(t,e,o,i,r,n,c){this._activatedRoute=t,this._dialog=e,this._formBuilder=o,this._orderService=i,this._productService=r,this._router=n,this._storeService=c,this.isChange=!1,this.isNewComment=!1,this.orderID="",this.statusesKeys=[],this.statusesValues=[],this.submitted=!1}addNewComment(t){let e="";localStorage.getItem("user")&&(e=JSON.parse(localStorage.getItem("user")).email);const o={date:(new Date).toString(),text:t,user:e};this.order.commentManager&&this.order.commentManager.length>0?this.order.commentManager.push(o):this.order.commentManager=[o]}addProductToOrder(t){const e=this._productService.getByTypeAndID(t.typeID,t.productID).subscribe(o=>{const i={amount:1,date:(new Date).toString(),id:t.productID,images:o.images,parameters:o.parameters,price:o.price,title:o.title,type:t.typeID};this.order.goods?this.order.goods[this.order.goods.length]=i:this.order.goods=[i],this.isChange=!0,this.updateTotalAmount(),e.unsubscribe()})}getOrder(){this._activatedRoute.params.pipe((0,n.w)(t=>(this.orderID=t.orderID,this._orderService.getOrder(this.orderID)))).subscribe(t=>{this.order=t,this.form.controls.status.setValue(t.status?t.status:"new"),this.updateTotalAmount()})}getStatuses(){for(let t in this._orderStatuses)this.statusesKeys.push(t),this.statusesValues.push(this._orderStatuses[t].uk)}initForm(){this.form=this._formBuilder.group({comment:new c.NI(""),status:new c.NI(null,c.kI.required)})}newProductPopup(){const t=this._dialog.open(N,{width:"1200px",maxHeight:"calc(100vh - 60px)",maxWidth:"calc(100% - 60px)"}).afterClosed().subscribe(e=>{if(!e)return void t.unsubscribe();let o=-1;if(this.order.goods&&(o=this.order.goods.findIndex(t=>t.id===e.productID)),-1!==o)return this.openNoticeDialog(),void t.unsubscribe();this.addProductToOrder(e),t.unsubscribe()})}ngOnInit(){this._orderStatuses=this._storeService.orderStatuses,this.getStatuses(),this.initForm(),this.getOrder()}openNoticeDialog(){this._dialog.open(Q.N,{data:{message:"<p>\u041e\u0431\u0440\u0430\u043d\u0438\u0439 \u0442\u043e\u0432\u0430\u0440 \u0432\u0436\u0435 \u0431\u0443\u0432 \u0434\u043e\u0434\u0430\u043d\u0438\u0439 \u0434\u043e \u0441\u043f\u0438\u0441\u043a\u0443 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u044c.</p>",buttonText:"\u0417\u0430\u043a\u0440\u0438\u0442\u0438"}})}removeProduct(t){var e,o;this.isChange=!0;let i=-1;this.order.goods&&(null===(e=this.order.goods)||void 0===e?void 0:e.length)>0&&(i=this.order.goods.findIndex(e=>e.type===t.typeID&&e.id===t.productID)),-1!==i&&(null===(o=this.order.goods)||void 0===o||o.splice(i,1)),this.updateTotalAmount()}showCommentField(){this.isNewComment=!0,this.isChange=!0}statusChange(t){this.isChange=!0,this.order.status=t.value}submit(){if(this.form.invalid)return;this._storeService.showPreloader.next(!0);const t=this.form.get("comment").value.trim();""!==t&&this.addNewComment(t),this.order.dateOfChange=(new Date).toString(),this._orderService.update(this.order).then(()=>{this.form.controls.comment.setValue(""),this.submitted=!1,this._storeService.showPreloader.next(!1),this._router.navigate(["/admin","order",this.order.id])},t=>{})}updateProduct(){this.isChange=!0,this.updateTotalAmount()}updateTotalAmount(){this.order.totalAmount=0,this.order.goods&&this.order.goods.forEach(t=>{this.order.totalAmount+=+t.price*t.amount})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(r.gz),s.Y36(a.uw),s.Y36(c.qu),s.Y36(D.p),s.Y36(p.M),s.Y36(r.F0),s.Y36(u.d))},t.\u0275cmp=s.Xpm({type:t,selectors:[["app-order-page"]],decls:6,vars:2,consts:[[1,"site__centered","site__pb"],[1,"site__title"],[4,"ngIf","ngIfElse"],["loading",""],[1,"nice-form","nice-form_fw",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-xs-12","col-md-6"],[1,"order-characteristics"],[3,"characteristic"],[3,"characteristic",4,"ngIf"],[1,"characteristic"],[1,"characteristic__title"],[1,"characteristic__title-wrap"],[1,"characteristic__inner"],[1,"characteristic__inner-wrap"],["appearance","fill",1,"characteristic__select"],["formControlName","status",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],[1,"col-xs-12","col-sm-6","sticky-column"],[4,"ngIf"],[1,"nice-form__row","nice-form__row_mb"],[1,"order-comment__wrap"],["type","button",1,"site__link","site__link_2",3,"click"],["class","order-comment",4,"ngIf"],[1,"order-comment"],[1,"order-comment__title"],["class","order-comment__wrap",4,"ngFor","ngForOf"],["class","nice-form__row nice-form__row_mb",4,"ngIf"],[1,"nice-form__row","nice-form__row_mb","nice-form__row_btn"],["type","submit",1,"btn",3,"disabled"],[3,"value"],[4,"ngFor","ngForOf"],[3,"product","removeProduct","changeProductAmount"],[1,"order-comment__txt"],[1,"order-comment__data"],["appearance","outline"],["formControlName","comment","matInput",""],[1,"loading-type-1"]],template:function(t,e){if(1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"h1",1),s._uU(2,"\u0421\u0442\u043e\u0440\u0456\u043d\u043a\u0430 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f"),s.qZA(),s.YNc(3,pt,43,33,"ng-container",2),s.YNc(4,dt,1,0,"ng-template",null,3,s.W1O),s.qZA()),2&t){const t=s.MAs(5);s.xp6(3),s.Q6J("ngIf",e.order)("ngIfElse",t)}},directives:[i.O5,c._Y,c.JL,c.sg,S,U.KE,Y.gD,c.JJ,c.u,i.sg,F.ey,E,U.hX,c.Fj,z.Nt,_.$g],pipes:[B.f,i.JJ,i.uU],styles:['.nice-form__row_mb{margin-bottom:30px}.nice-form__row_btn{text-align:center}.characteristic{margin-bottom:15px}.characteristic__title{line-height:1.3;font-weight:500}.characteristic__inner{line-height:1.3;font-weight:300}.characteristic__select .mat-form-field-wrapper{padding-bottom:4px}.characteristic__select .mat-form-field-underline{bottom:4px}.characteristic__select .mat-form-field-infix{border-top:none}.characteristic__select .mat-select-arrow-wrapper{transform:translateY(0)!important}.characteristic__title-wrap{margin-bottom:3px}.order-characteristics,.order-comment{margin-bottom:30px}.order-comment__title{font-size:18px;font-weight:500;line-height:1.3;margin-bottom:15px}.order-comment__wrap{padding-left:10px;margin-bottom:30px}.order-comment__wrap:last-child{margin-bottom:0}.order-comment__data{padding-top:7px;font-weight:300;line-height:1.4;font-size:11px}.order-comment__txt{padding-left:10px;border-left:1px solid var(--border-color);font-size:13px;font-weight:400;line-height:1.4}@media screen and (min-width:768px){.nice-form__row_btn{padding-top:30px}.characteristic{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:space-between;position:relative}.characteristic:before{content:"";position:absolute;left:0;bottom:4px;width:100%;border-bottom:1px dotted var(--border-color)}.characteristic__title{position:relative;align-self:flex-start;width:40%}.characteristic__title-wrap{position:relative;display:inline-block;padding-right:15px;background:#fff;margin-bottom:0}.characteristic__inner{width:60%;text-align:right}.characteristic__inner-wrap{position:relative;display:inline-block;padding-left:15px;background:#fff}.order-characteristics{margin-bottom:60px}.sticky-column{position:sticky;top:0}.order-comment__title{font-size:20px}}@media screen and (min-width:1024px){.order-comment__title{font-size:24px}.order-comment__data{font-size:13px}.order-comment__txt{font-size:16px}}'],encapsulation:2}),t})()}];let lt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=s.oAB({type:t}),t.\u0275inj=s.cJS({imports:[[r.Bz.forChild(ut)],r.Bz]}),t})();var gt=o(866),mt=o(4040);let _t=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=s.oAB({type:t}),t.\u0275inj=s.cJS({imports:[[i.ez]]}),t})(),ht=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=s.oAB({type:t}),t.\u0275inj=s.cJS({imports:[[i.ez,c.u5,z.c,gt.Z,r.Bz]]}),t})();var ft=o(5800),xt=o(2182),bt=o(7913);let Zt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=s.oAB({type:t}),t.\u0275inj=s.cJS({imports:[[ft.d,i.ez,xt.y,l.p9,a.Is,_.Cq,bt.ProductPageModule,r.Bz]]}),t})(),vt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=s.oAB({type:t}),t.\u0275inj=s.cJS({imports:[[_t,i.ez,mt.h,ht,lt,z.c,_.Cq,Y.LD,Zt,c.UX,gt.Z]]}),t})()}}]);